<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìö</text></svg>">
    <script data-goatcounter="https://jrenedo.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>

    <title>Simulacro Examen - AD</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #eef2ff; 
            min-height: 100vh; 
            display: flex; 
            flex-direction: column;
        }
        
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .option-card { transition: all 0.2s ease; }
        .option-card:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        
        .sticky-footer {
            position: sticky;
            bottom: 0;
            background: white;
            border-top: 1px solid #e5e7eb;
            padding: 1rem;
            z-index: 50;
            border-bottom-left-radius: 1rem;
            border-bottom-right-radius: 1rem;
            box-shadow: 0 -4px 6px -1px rgba(0, 0, 0, 0.05);
        }
    </style>
</head>
<body class="py-8 px-4">

    <div class="bg-white rounded-2xl shadow-xl w-full max-w-3xl mx-auto border-t-4 border-indigo-600 flex flex-col relative">
        
        <div class="bg-indigo-600 p-5 text-white flex justify-between items-center rounded-t-lg shadow-sm z-10">
            <h1 class="text-lg font-bold flex items-center gap-2">
                <i class="fas fa-book-reader"></i> Simulacro General
            </h1>
            <div id="status-bar" class="hidden flex gap-3 text-sm font-medium">
                <div class="bg-indigo-700 px-3 py-1 rounded-lg flex items-center gap-2">
                    <span class="text-indigo-200"><i class="fas fa-check"></i> <span id="score-display">0</span></span>
                    <span class="text-red-200 ml-2"><i class="fas fa-times"></i> <span id="errors-display">0</span></span>
                </div>
                <div class="bg-indigo-500 px-3 py-1 rounded-full w-20 text-center">
                    <span id="current-q">1</span>/<span id="total-q">0</span>
                </div>
            </div>
        </div>

        <div class="p-6 sm:p-8 flex-grow">
            
            <div id="start-screen" class="text-center space-y-8 fade-in py-8">
                <div class="w-24 h-24 bg-indigo-100 rounded-full flex items-center justify-center mx-auto text-indigo-600 text-4xl mb-4 shadow-sm">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <div>
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">Simulacro de Examen</h2>
                    <p class="text-gray-500">Bater√≠a de preguntas oficiales de repaso.</p>
                </div>
                
                <div class="grid grid-cols-2 gap-4 max-w-xs mx-auto text-sm text-gray-600">
                    <div class="bg-white p-3 rounded-lg border border-gray-200 shadow-sm">
                        <i class="fas fa-list-ol text-indigo-500 mb-1 block text-lg"></i>
                        <span id="start-total-q">--</span> Preguntas
                    </div>
                    <div class="bg-white p-3 rounded-lg border border-gray-200 shadow-sm">
                        <i class="fas fa-random text-indigo-500 mb-1 block text-lg"></i>
                        Orden Aleatorio
                    </div>
                </div>

                <button onclick="startQuiz()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-10 rounded-xl w-full max-w-sm mx-auto shadow-lg transition-transform transform hover:scale-105 flex justify-center items-center gap-2 text-lg">
                    <i class="fas fa-play"></i> Comenzar Test
                </button>
            </div>

            <div id="quiz-screen" class="hidden flex flex-col fade-in">
                
                <div class="mb-6">
                    <span class="text-xs font-bold text-indigo-600 uppercase tracking-wider mb-2 block">Pregunta</span>
                    <h3 id="question-text" class="text-xl sm:text-2xl font-bold text-gray-800 leading-snug"></h3>
                </div>

                <div id="options-container" class="space-y-3">
                    </div>

                <div id="feedback-area" class="hidden mt-8 pt-6 border-t border-gray-100 fade-in">
                    <div class="flex gap-4 mb-4 items-start bg-indigo-50 p-5 rounded-xl border border-indigo-100 shadow-sm">
                        <div id="feedback-icon" class="text-2xl flex-shrink-0 mt-1"></div>
                        <div>
                            <h4 id="feedback-title" class="font-bold text-base mb-1"></h4>
                            <p id="feedback-text" class="text-gray-700 text-sm leading-relaxed"></p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="result-screen" class="hidden text-center space-y-8 fade-in py-8">
                <div class="relative inline-block">
                    <div class="w-32 h-32 mx-auto rounded-full flex items-center justify-center text-5xl shadow-xl relative z-10 bg-white border-4" id="score-circle"></div>
                </div>
                
                <div>
                    <h2 class="text-4xl font-black text-gray-800 mb-1" id="final-score-text">0/0</h2>
                    <p class="text-gray-500 text-sm font-semibold uppercase">Resultado Final</p>
                </div>

                <div class="w-full bg-gray-200 rounded-full h-3 overflow-hidden max-w-sm mx-auto">
                    <div id="final-progress-bar" class="bg-indigo-600 h-full rounded-full transition-all duration-1000" style="width: 0%"></div>
                </div>
                
                <p id="score-message" class="font-medium text-indigo-700 text-lg"></p>

                <div class="flex flex-col gap-3 max-w-xs mx-auto pt-4">
                    <button id="retry-failed-btn" onclick="restartQuiz(true)" class="hidden bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-lg shadow-md w-full transition-colors flex justify-center items-center gap-2">
                        <i class="fas fa-hammer"></i> Repasar Fallos
                    </button>
                    <button onclick="restartQuiz(false)" class="bg-white border-2 border-indigo-600 text-indigo-600 hover:bg-indigo-50 font-bold py-3 px-6 rounded-lg w-full transition-colors">
                        <i class="fas fa-redo"></i> Reiniciar Todo
                    </button>
                </div>
            </div>

        </div>

        <div id="next-container" class="hidden sticky-footer">
            <button onclick="nextQuestion()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 rounded-xl text-lg shadow-md transition-colors flex justify-center items-center gap-2">
                Siguiente Pregunta <i class="fas fa-arrow-right"></i>
            </button>
        </div>

    </div>

    <script>
        // --- BASE DE DATOS DE PREGUNTAS (LITERALES) ---
        const rawQuestions = [
            
            // --- TEMA: FICHEROS (IO) ---
            {
                q: "¬øQu√© es un b√∫fer en el contexto de la gesti√≥n de ficheros?",
                options: [
                    "Un stream para leer datos secuencialmente desde una conexi√≥n de red.",
                    [cite_start]"Un bloque de memoria que permite almacenar temporalmente los datos para reducir accesos al disco.", // Correcta [cite: 254]
                    "Un almac√©n de datos permanente en el disco duro.",
                    "Una librer√≠a XML."
                ],
                correct: 1,
                justification: "El uso de un b√∫fer (memoria intermedia) permite leer o escribir bloques grandes de datos de una vez, reduciendo el n√∫mero de operaciones lentas de I/O sobre el disco f√≠sico."
            },
            {
                q: "¬øQu√© clase del paquete java.io lee ficheros de texto de manera eficiente utilizando un b√∫fer de entrada?",
                options: [
                    "BufferedWriter",
                    "FileReader",
                    [cite_start]"BufferedReader", // Correcta [cite: 233]
                    "FileInputStream"
                ],
                correct: 2,
                justification: "BufferedReader envuelve a un Reader (como FileReader) para a√±adirle la capacidad de buffering, mejorando el rendimiento en la lectura de texto."
            },
            {
                q: "En Java, para asegurar que el separador de directorios en una ruta (/ o \\) sea correcto independientemente del sistema operativo, ¬øqu√© constante de la clase File se debe usar?",
                options: [
                    "File.PATH_SEPARATOR",
                    [cite_start]"File.SEPARATOR", // Correcta seg√∫n PDF (aunque en Java es min√∫scula) [cite: 237]
                    "File.OS_SEPARATOR",
                    "File.SYSTEM_SEPARATOR"
                ],
                correct: 1,
                justification: "Nota: La constante est√°ndar en Java es 'File.separator', pero en los ex√°menes a menudo aparece referenciada en may√∫sculas como File.SEPARATOR para indicar el car√°cter separador de rutas."
            },
            {
                q: "En el contexto de la documentaci√≥n de c√≥digo Java, ¬øqu√© funci√≥n tiene el tag @since en un bloque de JavaDoc?",
                options: [
                    "Sirve para poner el autor del desarrollo.",
                    [cite_start]"Se usa para definir la versi√≥n del m√©todo o la clase (desde cu√°ndo existe).", // Correcta [cite: 242]
                    "Define los par√°metros de entrada.",
                    "Marca el c√≥digo como obsoleto."
                ],
                correct: 1,
                justification: "La etiqueta @since indica la versi√≥n del software en la que se introdujo esa funcionalidad espec√≠fica."
            },
             {
                q: "¬øQu√© es un Stream (Flujo) en Java?",
                options: [
                    "Un fichero de estilos.",
                    [cite_start]"Una abstracci√≥n que representa una secuencia de datos con un origen y un destino.", // Correcta [cite: 251]
                    "Una base de datos en memoria.",
                    "Un tipo de variable est√°tica."
                ],
                correct: 1,
                justification: "Los Streams son canales unidireccionales utilizados para mover bytes o caracteres de un origen a un destino de forma secuencial."
            },

            // --- TEMA: JDBC / BASES DE DATOS EMBEBIDAS ---
            {
                q: "¬øCu√°l es la principal caracter√≠stica y ventaja de una base de datos embebida?",
                options: [
                    "Requiere una interfaz externa para su mantenimiento.",
                    "Se conecta a trav√©s de un driver ODBC.",
                    [cite_start]"Se instala y se ejecuta como parte del software de la aplicaci√≥n, siendo invisible para el usuario.", // Correcta [cite: 10]
                    "Es ideal para gestionar grandes cantidades de datos distribuidos."
                ],
                correct: 2,
                justification: "Al ser embebida, la base de datos corre dentro del mismo proceso que la aplicaci√≥n Java, eliminando la necesidad de administrar un servidor de base de datos separado."
            },
            {
                q: "¬øCu√°l es el principal prop√≥sito de la API JDBC (Java Database Connectivity)?",
                options: [
                    "Implementar MVC.",
                    [cite_start]"Establecer una conexi√≥n y comunicaci√≥n uniforme entre una aplicaci√≥n Java y un controlador de base de datos relacional.", // Correcta [cite: 14]
                    "Permitir la creaci√≥n de bases de datos embebidas.",
                    "Facilitar el mapeo Objeto-Relacional (ORM)."
                ],
                correct: 1,
                justification: "JDBC proporciona una interfaz est√°ndar para que las aplicaciones Java puedan enviar sentencias SQL a cualquier base de datos relacional."
            },
            {
                q: "¬øQu√© interfaz JDBC se utiliza exclusivamente para recoger el resultado de una consulta de selecci√≥n (SELECT)?",
                options: [
                    [cite_start]"ResultSet", // Correcta [cite: 178]
                    "Connection",
                    "Statement",
                    "CallableStatement"
                ],
                correct: 0,
                justification: "ResultSet act√∫a como una tabla de datos en memoria que contiene el resultado de la consulta SQL y un cursor para recorrerlo."
            },
            {
                q: "¬øCu√°l es la interfaz JDBC recomendada para ejecutar operaciones SQL con par√°metros din√°micos (?) por seguridad?",
                options: [
                    "CallableStatement",
                    [cite_start]"PreparedStatement", // Correcta [cite: 184]
                    "Statement",
                    "ResultSet"
                ],
                correct: 1,
                justification: "PreparedStatement precompila la consulta y gestiona los par√°metros de forma segura, evitando la inyecci√≥n SQL."
            },
            {
                q: "¬øQu√© m√©todo de la interfaz Connection debe establecerse a false para poder gestionar las transacciones de manera manual?",
                options: [
                    "commit()",
                    "getConnection()",
                    "rollback()",
                    [cite_start]"setAutoCommit(boolean)" // Correcta [cite: 194]
                ],
                correct: 3,
                justification: "Al establecer setAutoCommit(false), se evita que cada sentencia se guarde autom√°ticamente, permitiendo agrupar varias operaciones en una sola transacci√≥n."
            },
            {
                q: "¬øQu√© comando SQL (DDL) se utiliza para eliminar por completo una tabla y todos sus registros?",
                options: [
                    [cite_start]"DROP", // Correcta [cite: 258]
                    "DELETE",
                    "ALTER",
                    "RENAME"
                ],
                correct: 0,
                justification: "La sentencia DROP elimina el objeto (la tabla) y su contenido. DELETE solo elimina las filas, pero mantiene la estructura."
            },

            // --- TEMA: XML / NATIVAS ---
            {
                q: "¬øCu√°l de las siguientes opciones se considera una ventaja de las Bases de Datos Nativa XML?",
                options: [
                    "La indexaci√≥n es sencilla como en relacional.",
                    "El espacio es m√≠nimo.",
                    [cite_start]"Permiten guardar datos de forma heterog√©nea y recuperar su integridad y estado original.", // Correcta [cite: 19]
                    "Modificaci√≥n at√≥mica en cualquier parte."
                ],
                correct: 2,
                justification: "Las NXD son ideales para datos semi-estructurados o heterog√©neos, preservando la estructura jer√°rquica original del XML."
            },
            {
                q: "El lenguaje XQuery est√° considerado como una extensi√≥n directa de qu√© otro est√°ndar:",
                options: [
                    [cite_start]"XPath 2.0", // Correcta [cite: 74]
                    "XSLT",
                    "XML Schema",
                    "XUpdate"
                ],
                correct: 0,
                justification: "XQuery incluye XPath 2.0 como subconjunto. Cualquier expresi√≥n XPath v√°lida es tambi√©n una consulta XQuery v√°lida."
            },
            {
                q: "¬øQu√© lenguaje es utilizado por las BBDD Nativas XML para recorrer los nodos de un documento?",
                options: [
                    "XUpdate",
                    "DOM",
                    "XSLT",
                    [cite_start]"XPath" // Correcta [cite: 85]
                ],
                correct: 3,
                justification: "XPath es el lenguaje est√°ndar dise√±ado espec√≠ficamente para navegar y seleccionar nodos dentro de un √°rbol XML."
            },
            {
                q: "¬øCu√°l es la caracter√≠stica principal de una Base de Datos Nativa XML (NXD)?",
                options: [
                    "Indexaci√≥n sencilla por defecto.",
                    [cite_start]"Guarda los datos exclusivamente en documentos XML, bas√°ndose en un modelo l√≥gico (DOM).", // Correcta [cite: 92]
                    "Almacena datos en tablas relacionales.",
                    "Usa un motor BLOB."
                ],
                correct: 1,
                justification: "Las bases de datos nativas definen un modelo l√≥gico basado en XML (√°rboles) para el almacenamiento y consulta, no filas y columnas."
            },
            {
                q: "¬øQu√© lenguaje de consulta se utiliza habitualmente para bases de datos XML?",
                options: [
                    "HQL",
                    "OQL",
                    "SQL",
                    [cite_start]"XQuery (XML Query Language)" // Correcta [cite: 100]
                ],
                correct: 3,
                justification: "XQuery es el est√°ndar recomendado por el W3C para consultar colecciones de datos XML."
            },
            {
                q: "En eXist-db, ¬øqu√© se entiende por 'recurso' y a qu√© equivale en un sistema de archivos?",
                options: [
                    "Un servicio.",
                    "Una colecci√≥n.",
                    "Un controlador.",
                    "Un fichero o documento (XML o binario)." [cite_start]// Correcta [cite: 109]
                ],
                correct: 3,
                justification: "En la jerarqu√≠a de una NXD, una Colecci√≥n es como una carpeta, y un Recurso es como un archivo dentro de esa carpeta."
            },
            {
                q: "En una Base de Datos Nativa XML, ¬øqu√© elemento desempe√±a un rol an√°logo al de las TABLAS en relacional?",
                options: [
                    [cite_start]"Las colecciones.", // Correcta [cite: 116]
                    "Los identificadores.",
                    "Los nodos XML.",
                    "Los recursos."
                ],
                correct: 0,
                justification: "Las Colecciones agrupan documentos (recursos) de manera similar a como las Tablas agrupan registros (filas)."
            },
            {
                q: "¬øQu√© API de an√°lisis sint√°ctico (parser) carga el documento XML completo en memoria como un √°rbol?",
                options: [
                    [cite_start]"DOM (Document Object Model)", // Correcta [cite: 226]
                    "SAX",
                    "XQuery",
                    "JAXB"
                ],
                correct: 0,
                justification: "DOM construye una representaci√≥n en √°rbol de todo el documento en la memoria RAM, permitiendo acceso aleatorio pero consumiendo m√°s recursos."
            },

            // --- TEMA: HIBERNATE / ORM ---
            {
                q: "¬øQu√© representa el llamado 'desfase objeto-relacional' (Impedance Mismatch)?",
                options: [
                    [cite_start]"La diferencia estructural y de relaciones entre la POO (Objetos) y las Bases de Datos Relacionales.", // Correcta [cite: 263]
                    "Un error de conexi√≥n JDBC.",
                    "La necesidad de usar DDL.",
                    "Un fallo de latencia."
                ],
                correct: 0,
                justification: "Es la dificultad conceptual y t√©cnica de mapear objetos (grafos, herencia) a tablas (filas, columnas)."
            },
            {
                q: "¬øQu√© interfaz de la API JPA es la encargada de gestionar el ciclo de vida de las entidades (persist, merge, remove)?",
                options: [
                    "EntityTransaction",
                    "PersistenceUnit",
                    [cite_start]"EntityManager", // Correcta [cite: 51]
                    "EntityManagerFactory"
                ],
                correct: 2,
                justification: "EntityManager es la interfaz principal de JPA para interactuar con el contexto de persistencia."
            },
            {
                q: "¬øCu√°l es una caracter√≠stica clave del HQL (Hibernate Query Language)?",
                options: [
                    "Requiere SQL nativo.",
                    "Solo se ejecuta en consola.",
                    "Est√° acoplado al gestor de BBDD.",
                    "Es orientado a objetos y es independiente del gestor de BBDD." [cite_start]// Correcta [cite: 126]
                ],
                correct: 3,
                justification: "HQL opera sobre clases y propiedades persistentes, no sobre tablas y columnas, lo que lo hace portable entre distintos SGBD."
            },
            {
                q: "¬øCu√°l es la funci√≥n principal de la interfaz Session en Hibernate?",
                options: [
                    "Configuraci√≥n inicial.",
                    "Transformar objetos a SQL.",
                    [cite_start]"Es un objeto ligero que gestiona las transacciones y operaciones CRUD de objetos persistentes.", // Correcta [cite: 134]
                    "Cerrar la SessionFactory."
                ],
                correct: 2,
                justification: "Session es el componente principal en Hibernate cl√°sico para crear, leer y borrar objetos de la base de datos."
            },
            {
                q: "En el ciclo de vida Hibernate, ¬øen qu√© estado est√° un objeto que tiene ID en la base de datos y est√° asociado a una sesi√≥n activa?",
                options: [
                    "Transitorio (Transient)",
                    [cite_start]"Persistente (Persistent)", // Correcta [cite: 138]
                    "Ligado (Bound)",
                    "Separado (Detached)"
                ],
                correct: 1,
                justification: "El estado Persistente significa que la instancia est√° siendo gestionada por el contexto de persistencia y tiene representaci√≥n en la BD."
            },
            {
                q: "¬øQu√© anotaci√≥n se utiliza para indicar que un atributo NO se debe guardar en la base de datos?",
                options: [
                    "@Id",
                    "@OrderBy",
                    [cite_start]"@Transient", // Correcta [cite: 199]
                    "@Column"
                ],
                correct: 2,
                justification: "@Transient indica al proveedor JPA que ignore ese campo durante el proceso de mapeo a la base de datos."
            },
            {
                q: "¬øCu√°l es la t√©cnica principal del ORM?",
                options: [
                    [cite_start]"La conversi√≥n autom√°tica de los datos de objetos a los atributos de las tablas relacionales y viceversa.", // Correcta [cite: 204]
                    "Sustituci√≥n de SQL por c√≥digo nativo.",
                    "Creaci√≥n de BBDD orientadas a objetos.",
                    "Uso exclusivo de JDBC."
                ],
                correct: 0,
                justification: "ORM (Object-Relational Mapping) automatiza el traslado de datos entre objetos en memoria y filas en tablas relacionales."
            },
            {
                q: "En un archivo de mapeo Hibernate (.hbm.xml), ¬øqu√© elemento define la clave primaria?",
                options: [
                    "<generator>",
                    "<property>",
                    "<class>",
                    [cite_start]"<id>" // Correcta [cite: 217]
                ],
                correct: 3,
                justification: "En la configuraci√≥n XML cl√°sica de Hibernate, la etiqueta <id> se utiliza para mapear el identificador √∫nico de la clase."
            },
            {
                q: "¬øCu√°l de las siguientes caracter√≠sticas destaca la independencia de la base de datos en las herramientas ORM?",
                options: [
                    "Solo compatibles con una BBDD.",
                    "Necesidad de reescribir consultas.",
                    "Uso obligatorio de XML.",
                    "La abstracci√≥n permite escribir consultas independientemente del gestor, facilitando la migraci√≥n." [cite_start]// Correcta [cite: 131]
                ],
                correct: 3,
                justification: "Gracias a los dialectos, el ORM traduce las consultas abstractas (HQL/JPQL) al SQL espec√≠fico del motor de base de datos subyacente."
            },

            // --- TEMA: PL/SQL Y OBJETOS ---
            {
                q: "En PL/SQL, ¬øqu√© tipo de dato se usa para almacenar datos complejos y grandes como im√°genes o videos?",
                options: [
                    "NUMBER",
                    [cite_start]"LARGE OBJECT (LOB)", // Correcta [cite: 62]
                    "BOOLEAN",
                    "BINARY_INTEGER"
                ],
                correct: 1,
                justification: "LOB (Large Object) es el tipo dise√±ado para almacenar grandes vol√∫menes de datos, ya sean binarios (BLOB) o de caracteres (CLOB)."
            },
            {
                q: "Una caracter√≠stica de las BDOO es la Encapsulaci√≥n. ¬øEn qu√© consiste?",
                options: [
                    [cite_start]"La ocultaci√≥n de informaci√≥n del objeto, evitando accesos incorrectos.", // Correcta [cite: 67]
                    "Operaci√≥n aplicable a distintas clases.",
                    "Crear nuevos tipos a partir de existentes.",
                    "Representaci√≥n en filas y columnas."
                ],
                correct: 0,
                justification: "La encapsulaci√≥n protege el estado interno del objeto, permitiendo el acceso solo a trav√©s de una interfaz definida."
            },
            {
                q: "En OQL (y XQuery FLWOR), ¬øqu√© s√≠mbolo se suele utilizar para definir una variable?",
                options: [
                    [cite_start]"$ (D√≥lar)", // Correcta [cite: 143]
                    "@",
                    "#",
                    "%"
                ],
                correct: 0,
                justification: "En las expresiones FLWOR y en muchos contextos de consulta, el s√≠mbolo '$' se utiliza como prefijo para declarar variables."
            },
            {
                q: "¬øQu√© sentencia SQL (DDL) se usa en PL/SQL para crear un nuevo tipo de dato objeto?",
                options: [
                    "CREATE CLASS",
                    [cite_start]"CREATE TYPE", // Correcta [cite: 148]
                    "DECLARE OBJECT",
                    "CREATE OBJECT"
                ],
                correct: 1,
                justification: "La sentencia 'CREATE TYPE ... AS OBJECT' es la sintaxis est√°ndar en Oracle para definir Tipos de Datos Definidos por el Usuario (UDT)."
            },
            {
                q: "¬øQu√© secci√≥n de un bloque PL/SQL es obligatoria y contiene la l√≥gica principal?",
                options: [
                    "EXCEPTION",
                    "END",
                    [cite_start]"BEGIN", // Correcta [cite: 154]
                    "DECLARE"
                ],
                correct: 2,
                justification: "Un bloque PL/SQL debe contener al menos la secci√≥n ejecutable delimitada por BEGIN y END."
            },
            {
                q: "En BDOO, ¬øc√≥mo se define el polimorfismo?",
                options: [
                    "Ocultaci√≥n de datos.",
                    [cite_start]"La propiedad de una operaci√≥n que puede aplicarse a objetos de distinta clase.", // Correcta [cite: 162]
                    "Capacidad de guardar sin mapeo.",
                    "Relaci√≥n jer√°rquica."
                ],
                correct: 1,
                justification: "El polimorfismo permite que una misma operaci√≥n o m√©todo se comporte de manera diferente seg√∫n la clase del objeto sobre el que act√∫a."
            },
            {
                q: "¬øQu√© utiliza OQL en sus sentencias en lugar de los nombres de tablas?",
                options: [
                    [cite_start]"El nombre de los atributos de la clase Java / Nombres de Clases.", // Correcta [cite: 166]
                    "Nombres de ficheros.",
                    "Direcciones de memoria.",
                    "IDs num√©ricos."
                ],
                correct: 0,
                justification: "OQL (Object Query Language) consulta sobre el modelo de objetos, utilizando nombres de clases y atributos en lugar de tablas y columnas."
            },

            // --- TEMA: EJB / COMPONENTES ---
            {
                q: "¬øQu√© tipo de EJB Session Bean mantiene el estado de conversaci√≥n (Stateful)?",
                options: [
                    "Singleton",
                    "Message Driven",
                    [cite_start]"Stateful", // Correcta [cite: 24]
                    "Stateless"
                ],
                correct: 2,
                justification: "Un Session Bean Stateful conserva el estado de la sesi√≥n del cliente entre m√∫ltiples llamadas a m√©todos."
            },
            {
                q: "¬øQu√© IDE es conocido por facilitar el desarrollo por m√≥dulos (Platform)?",
                options: [
                    "JBuilder",
                    "IntelliJ Idea",
                    [cite_start]"NetBeans", // Correcta [cite: 29]
                    "Eclipse"
                ],
                correct: 2,
                justification: "NetBeans destaca por su soporte a la arquitectura de m√≥dulos y la plataforma NetBeans para aplicaciones de escritorio complejas."
            },
            {
                q: "En EJB, ¬øqu√© anotaci√≥n indica que los m√©todos pueden ser invocados por un cliente remoto?",
                options: [
                    "@Entity",
                    [cite_start]"@Remote", // Correcta [cite: 33]
                    "@Stateless",
                    "@Local"
                ],
                correct: 1,
                justification: "La anotaci√≥n @Remote expone la interfaz del bean para que pueda ser accedida desde fuera de la JVM local."
            },
            {
                q: "En JavaBeans, ¬øc√≥mo se llama la propiedad que representa una lista de valores accesible por √≠ndice?",
                options: [
                    "Propiedad Restringida",
                    [cite_start]"Propiedad Indexada", // Correcta [cite: 40]
                    "Propiedad Ligada",
                    "Propiedad Simple"
                ],
                correct: 1,
                justification: "Las propiedades indexadas manejan colecciones de datos, permitiendo el acceso a elementos individuales mediante un √≠ndice entero."
            },
            {
                q: "¬øCu√°l NO es un tipo principal de EJB?",
                options: [
                    "Beans de Entidad (Entity Beans)",
                    [cite_start]"Beans de Interfaz (Interface Beans)", // Correcta [cite: 45]
                    "Beans Controlados por Mensajes (MDB)",
                    "Beans de Sesi√≥n (Session Beans)"
                ],
                correct: 1,
                justification: "Los tipos principales de EJB son Session Beans, Entity Beans (en versiones antiguas, ahora JPA) y Message Driven Beans. 'Interface Beans' no es una categor√≠a."
            },
            {
                q: "¬øQu√© propiedad de un Java Bean desencadena un evento cuando su valor cambia?",
                options: [
                    "Propiedad Restringida",
                    "Propiedad Simple",
                    "Propiedad Indexada",
                    [cite_start]"Propiedad Ligada (Bound)" // Correcta [cite: 57]
                ],
                correct: 3,
                justification: "Una propiedad ligada (Bound) notifica a los oyentes registrados (Listeners) cada vez que su valor es modificado."
            },

            // --- PREGUNTA ADICIONAL (MANUALES) ---
            {
                q: "En el manual de administraci√≥n:",
                options: [
                    "Es preciso indicar al usuario los pasos para trabajar.",
                    "Hace √©nfasis en la extensi√≥n.",
                    "Se dispone de un resumen de aspectos importantes.",
                    "Viene detallado el proceso de CONFIGURACI√ìN de aquellos componentes que forman parte del sistema." // Correcta
                ],
                correct: 3,
                justification: "El Manual de Administraci√≥n est√° dirigido al personal t√©cnico encargado de instalar, configurar y mantener el sistema, a diferencia del manual de usuario que explica c√≥mo usarlo."
            }
        ];

        // --- L√ìGICA DEL TEST ---
        let quizQuestions = [], failedQuestions = [], currentQuestionIndex = 0;
        let score = 0, errors = 0, isAnswered = false, isRetryMode = false;

        // Referencias DOM
        const els = {
            start: document.getElementById('start-screen'),
            quiz: document.getElementById('quiz-screen'),
            result: document.getElementById('result-screen'),
            status: document.getElementById('status-bar'),
            nextCont: document.getElementById('next-container'),
            qText: document.getElementById('question-text'),
            opts: document.getElementById('options-container'),
            curQ: document.getElementById('current-q'),
            totQ: document.getElementById('total-q'),
            scDisp: document.getElementById('score-display'),
            errDisp: document.getElementById('errors-display'),
            fbArea: document.getElementById('feedback-area'),
            fbTitle: document.getElementById('feedback-title'),
            fbText: document.getElementById('feedback-text'),
            fbIcon: document.getElementById('feedback-icon'),
            startTotal: document.getElementById('start-total-q')
        };

        // Inicializar
        els.startTotal.innerText = rawQuestions.length || 0;

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function startQuiz(retryMode = false) {
            isRetryMode = retryMode;
            let source = retryMode ? failedQuestions : JSON.parse(JSON.stringify(rawQuestions));
            
            if (source.length === 0) return alert("No hay preguntas para repasar.");

            // Barajar preguntas y opciones
            quizQuestions = shuffle([...source]).map(q => {
                const correctTxt = q.options[q.correct];
                q.options = shuffle(q.options);
                q.correct = q.options.indexOf(correctTxt);
                return q;
            });

            failedQuestions = [];
            currentQuestionIndex = 0; score = 0; errors = 0;
            updateStats();
            
            // UI Switch
            els.start.classList.add('hidden');
            els.result.classList.add('hidden');
            els.quiz.classList.remove('hidden');
            els.status.classList.remove('hidden');
            els.nextCont.classList.add('hidden'); 
            
            renderQuestion();
        }

        function updateStats() {
            els.curQ.innerText = currentQuestionIndex + 1;
            els.totQ.innerText = quizQuestions.length;
            els.scDisp.innerText = score;
            els.errDisp.innerText = errors;
        }

        function renderQuestion() {
            isAnswered = false;
            const q = quizQuestions[currentQuestionIndex];
            
            updateStats();
            els.qText.innerText = q.q;
            els.opts.innerHTML = '';
            els.fbArea.classList.add('hidden');
            els.nextCont.classList.add('hidden');
            
            window.scrollTo(0, 0);

            q.options.forEach((opt, index) => {
                const btn = document.createElement('button');
                btn.className = "option-card w-full text-left p-4 rounded-xl border-2 border-gray-200 bg-white text-gray-700 font-medium flex items-center gap-3 group hover:border-indigo-300";
                
                const letter = String.fromCharCode(65 + index);
                btn.innerHTML = `<span class="flex-shrink-0 w-8 h-8 flex items-center justify-center bg-gray-100 text-gray-500 rounded-full font-bold text-sm transition-colors group-hover:bg-indigo-100 group-hover:text-indigo-600">${letter}</span><span class="leading-snug">${opt}</span>`;
                
                btn.onclick = () => checkAnswer(index, btn);
                els.opts.appendChild(btn);
            });
        }

        function checkAnswer(idx, btn) {
            if (isAnswered) return;
            isAnswered = true;
            const q = quizQuestions[currentQuestionIndex];
            const isCorrect = idx === q.correct;
            const allBtns = els.opts.children;

            Array.from(allBtns).forEach(b => {
                b.disabled = true;
                b.classList.add('opacity-60', 'cursor-not-allowed');
                b.classList.remove('hover:border-indigo-300');
            });
            btn.classList.remove('opacity-60');

            if (isCorrect) {
                score++;
                styleBtn(btn, 'correct');
                showFeedback(true, q.justification);
            } else {
                errors++;
                failedQuestions.push(q);
                styleBtn(btn, 'incorrect');
                const correctBtn = allBtns[q.correct];
                correctBtn.classList.remove('opacity-60');
                styleBtn(correctBtn, 'correct');
                showFeedback(false, q.justification);
            }
            
            updateStats();
            els.nextCont.classList.remove('hidden');
        }

        function styleBtn(btn, type) {
            btn.classList.remove('border-gray-200', 'bg-white', 'text-gray-700');
            if (type === 'correct') {
                btn.classList.add('border-green-500', 'bg-green-50', 'text-green-900');
                btn.querySelector('span:first-child').className = "flex-shrink-0 w-8 h-8 flex items-center justify-center bg-green-200 text-green-700 rounded-full font-bold text-sm";
            } else {
                btn.classList.add('border-red-500', 'bg-red-50', 'text-red-900');
                btn.querySelector('span:first-child').className = "flex-shrink-0 w-8 h-8 flex items-center justify-center bg-red-200 text-red-700 rounded-full font-bold text-sm";
            }
        }

        function showFeedback(isCorrect, text) {
            els.fbArea.classList.remove('hidden');
            els.fbIcon.innerHTML = isCorrect ? '<i class="fas fa-check-circle text-green-500"></i>' : '<i class="fas fa-times-circle text-red-500"></i>';
            els.fbTitle.innerText = isCorrect ? "¬°Correcto!" : "Soluci√≥n Correcta:";
            els.fbTitle.className = `font-bold text-base mb-1 ${isCorrect ? 'text-green-700' : 'text-red-700'}`;
            els.fbText.innerText = text || "Sin justificaci√≥n.";
            
            setTimeout(() => {
                window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
            }, 100);
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < quizQuestions.length) {
                renderQuestion();
            } else {
                showResult();
            }
        }

        function showResult() {
            els.quiz.classList.add('hidden');
            els.status.classList.add('hidden');
            els.nextCont.classList.add('hidden');
            els.result.classList.remove('hidden');

            const total = quizQuestions.length;
            const pct = Math.round((score / total) * 100);
            
            document.getElementById('final-score-text').innerText = `${score} / ${total}`;
            document.getElementById('final-progress-bar').style.width = `${pct}%`;

            const retryBtn = document.getElementById('retry-failed-btn');
            retryBtn.classList.toggle('hidden', failedQuestions.length === 0);
            if (failedQuestions.length > 0) retryBtn.innerHTML = `<i class="fas fa-hammer"></i> Repasar ${failedQuestions.length} Fallos`;

            const circle = document.getElementById('score-circle');
            const msg = document.getElementById('score-message');
            circle.className = "w-32 h-32 mx-auto rounded-full flex items-center justify-center text-5xl shadow-xl relative z-10 bg-white border-4 mb-4";

            if (pct >= 90) {
                circle.classList.add('border-indigo-500', 'text-indigo-600');
                circle.innerHTML = '<i class="fas fa-trophy"></i>';
                msg.innerText = "¬°IMPRESIONANTE! Nivel Experto üèÜ";
            } else if (pct >= 50) {
                circle.classList.add('border-blue-500', 'text-blue-600');
                circle.innerHTML = '<i class="fas fa-thumbs-up"></i>';
                msg.innerText = "¬°Aprobado! Buen trabajo üëç";
            } else {
                circle.classList.add('border-red-500', 'text-red-600');
                circle.innerHTML = '<i class="fas fa-book-open"></i>';
                msg.innerText = "Toca estudiar m√°s... üìö";
            }
        }

        function restartQuiz(retry) {
            startQuiz(retry);
        }
    </script>
</body>
</html>