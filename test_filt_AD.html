<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test AD - Repaso Intensivo</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìö</text></svg>">
    <script data-goatcounter="https://jrenedo.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .btn-option { transition: all 0.2s; }
        .btn-option:hover { transform: translateX(5px); }
    </style>
</head>
<body class="bg-slate-900 text-slate-200 min-h-screen font-sans">

    <div class="fixed top-0 w-full bg-slate-800 border-b border-slate-700 z-10 shadow-lg">
        <div class="max-w-3xl mx-auto px-4 py-3 flex justify-between items-center">
            <h1 class="text-lg font-bold text-blue-400 flex items-center gap-2">
                üìö Test Acceso a Datos
            </h1>
            <div class="text-sm font-mono">
                <span id="score" class="text-green-400 font-bold">0</span> Aciertos | 
                <span id="errors" class="text-red-400 font-bold">0</span> Fallos
            </div>
        </div>
        <div class="h-1 w-full bg-slate-900">
            <div id="progress-bar" class="h-full bg-blue-500 transition-all duration-300" style="width: 0%"></div>
        </div>
    </div>

    <div class="max-w-2xl mx-auto mt-20 p-4 pb-20">
        
        <div id="quiz-container" class="bg-slate-800 rounded-xl shadow-2xl p-6 border border-slate-700 relative overflow-hidden">
            
            <span id="topic-badge" class="absolute top-0 right-0 bg-slate-700 text-xs text-slate-400 px-3 py-1 rounded-bl-lg font-mono tracking-tighter">
                TEMA
            </span>

            <h2 id="question-text" class="text-xl md:text-2xl font-bold text-white mb-6 leading-tight mt-2">
                Cargando pregunta...
            </h2>

            <div id="options-container" class="space-y-3">
                </div>

            <div id="feedback-container" class="hidden mt-6 pt-4 border-t border-slate-700 fade-in">
                <div id="feedback-title" class="font-bold text-lg mb-1"></div>
                <p id="feedback-text" class="text-slate-300 text-sm leading-relaxed"></p>
                <button onclick="nextQuestion()" class="mt-4 w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 rounded-lg shadow-lg transform active:scale-95 transition-all">
                    Siguiente Pregunta ‚ûú
                </button>
            </div>
        </div>

    </div>

    <script>
        // --- BASE DE DATOS DE PREGUNTAS ---
        const rawQuestions = [
            // === TEMA: FICHEROS ===
            {
                q: "¬øQu√© es un b√∫fer en el contexto de la gesti√≥n de ficheros?",
                options: [
                    "Un stream para leer datos secuencialmente desde una conexi√≥n de red.",
                    "Un bloque de memoria que permite almacenar temporalmente los datos para reducir accesos al disco.",
                    "Un almac√©n de datos permanente en el disco duro.",
                    "Una librer√≠a XML."
                ],
                correct: 1,
                justification: "El b√∫fer (memoria intermedia) reduce las operaciones de entrada/salida f√≠sicas al disco, mejorando el rendimiento."
            },
            {
                q: "¬øQu√© clase del paquete java.io lee ficheros de texto de manera eficiente utilizando un b√∫fer de entrada?",
                options: [
                    "BufferedWriter",
                    "FileReader",
                    "BufferedReader",
                    "FileInputStream"
                ],
                correct: 2,
                justification: "BufferedReader envuelve a un Reader (como FileReader) para a√±adirle la capacidad de buffering."
            },
            {
                q: "En Java, para asegurar que el separador de directorios en una ruta (/ o \\) sea correcto independientemente del sistema operativo, ¬øqu√© constante de la clase File se debe usar?",
                options: [
                    "File.PATH_SEPARATOR",
                    "File.SEPARATOR", 
                    "File.OS_SEPARATOR",
                    "File.SYSTEM_SEPARATOR"
                ],
                correct: 1,
                justification: "Nota: Aunque la convenci√≥n Java suele ser min√∫sculas, la constante est√°tica a veces se referencia en may√∫sculas en ciertos contextos o ex√°menes como File.SEPARATOR."
            },
            {
                q: "En el contexto de la documentaci√≥n de c√≥digo Java, ¬øqu√© funci√≥n tiene el tag @since en un bloque de JavaDoc?",
                options: [
                    "Sirve para poner el autor del desarrollo.",
                    "Se usa para definir la versi√≥n del m√©todo o la clase (desde cu√°ndo existe).",
                    "Define los par√°metros de entrada.",
                    "Marca el c√≥digo como obsoleto."
                ],
                correct: 1,
                justification: "@since indica desde qu√© versi√≥n del software est√° disponible esa funcionalidad."
            },
             {
                q: "¬øQu√© es un Stream (Flujo) en Java?",
                options: [
                    "Un fichero de estilos.",
                    "Una abstracci√≥n que representa una secuencia de datos con un origen y un destino.",
                    "Una base de datos en memoria.",
                    "Un tipo de variable est√°tica."
                ],
                correct: 1,
                justification: "Los Streams son canales unidireccionales para mover bytes o caracteres de un origen a un destino."
            },

            // === TEMA: JDBC / BASES DE DATOS ===
            {
                q: "¬øCu√°l es la principal caracter√≠stica y ventaja de una base de datos embebida?",
                options: [
                    "Requiere una interfaz externa para su mantenimiento.",
                    "Se conecta a trav√©s de un driver ODBC.",
                    "Se instala y se ejecuta como parte del software de la aplicaci√≥n, siendo invisible para el usuario.",
                    "Es ideal para gestionar grandes cantidades de datos distribuidos."
                ],
                correct: 2,
                justification: "Al ser embebida (como SQLite o H2), vive dentro de tu propia aplicaci√≥n Java, no necesita un servidor separado."
            },
            {
                q: "¬øCu√°l es el principal prop√≥sito de la API JDBC (Java Database Connectivity)?",
                options: [
                    "Implementar MVC.",
                    "Establecer una conexi√≥n y comunicaci√≥n uniforme entre una aplicaci√≥n Java y un controlador de base de datos relacional.",
                    "Permitir la creaci√≥n de bases de datos embebidas.",
                    "Facilitar el mapeo Objeto-Relacional (ORM)."
                ],
                correct: 1,
                justification: "JDBC es el est√°ndar de bajo nivel para que Java 'hable' SQL con cualquier base de datos."
            },
            {
                q: "¬øQu√© interfaz JDBC se utiliza exclusivamente para recoger el resultado de una consulta de selecci√≥n (SELECT)?",
                options: [
                    "ResultSet",
                    "Connection",
                    "Statement",
                    "CallableStatement"
                ],
                correct: 0,
                justification: "ResultSet es la 'hoja de resultados' que te devuelve la base de datos tras un SELECT."
            },
            {
                q: "¬øCu√°l es la interfaz JDBC recomendada para ejecutar operaciones SQL con par√°metros din√°micos (?) por seguridad?",
                options: [
                    "CallableStatement",
                    "PreparedStatement",
                    "Statement",
                    "ResultSet"
                ],
                correct: 1,
                justification: "PreparedStatement precompila la consulta y usa '?' para evitar la inyecci√≥n SQL."
            },
            {
                q: "¬øQu√© m√©todo de la interfaz Connection debe establecerse a false para poder gestionar las transacciones de manera manual?",
                options: [
                    "commit()",
                    "getConnection()",
                    "rollback()",
                    "setAutoCommit(boolean)"
                ],
                correct: 3,
                justification: "conn.setAutoCommit(false) desactiva el guardado autom√°tico, oblig√°ndote a hacer commit() o rollback() manualmente."
            },

            // === TEMA: XML / NATIVAS ===
            {
                q: "¬øCu√°l de las siguientes opciones se considera una ventaja de las Bases de Datos Nativa XML?",
                options: [
                    "La indexaci√≥n es sencilla como en relacional.",
                    "El espacio es m√≠nimo.",
                    "Permiten guardar datos de forma heterog√©nea y recuperar su integridad y estado original.",
                    "Modificaci√≥n at√≥mica en cualquier parte."
                ],
                correct: 2,
                justification: "Son ideales para datos semi-estructurados o heterog√©neos donde el esquema var√≠a."
            },
            {
                q: "El lenguaje XQuery est√° considerado como una extensi√≥n directa de qu√© otro est√°ndar:",
                options: [
                    "XPath 2.0",
                    "XSLT",
                    "XML Schema",
                    "XUpdate"
                ],
                correct: 0,
                justification: "XQuery incluye a XPath 2.0 completo. Todo XPath es un XQuery v√°lido."
            },
            {
                q: "¬øQu√© lenguaje es utilizado por las BBDD Nativas XML para recorrer los nodos de un documento?",
                options: [
                    "XUpdate",
                    "DOM",
                    "XSLT",
                    "XPath"
                ],
                correct: 3,
                justification: "XPath es el lenguaje de 'rutas' para navegar por el √°rbol XML."
            },
            {
                q: "¬øCu√°l es la caracter√≠stica principal de una Base de Datos Nativa XML (NXD)?",
                options: [
                    "Indexaci√≥n sencilla por defecto.",
                    "Guarda los datos exclusivamente en documentos XML, bas√°ndose en un modelo l√≥gico (DOM).",
                    "Almacena datos en tablas relacionales.",
                    "Usa un motor BLOB."
                ],
                correct: 1,
                justification: "Mantiene la estructura de √°rbol del XML, no lo rompe en tablas."
            },
            {
                q: "¬øQu√© lenguaje de consulta se utiliza habitualmente para bases de datos XML?",
                options: [
                    "HQL",
                    "OQL",
                    "SQL",
                    "XQuery (XML Query Language)"
                ],
                correct: 3,
                justification: "XQuery es el est√°ndar W3C para consultar colecciones XML."
            },
            {
                q: "En eXist-db, ¬øqu√© se entiende por 'recurso' y a qu√© equivale en un sistema de archivos?",
                options: [
                    "Un servicio.",
                    "Una colecci√≥n.",
                    "Un controlador.",
                    "Un fichero o documento (XML o binario)."
                ],
                correct: 3,
                justification: "Colecci√≥n = Carpeta. Recurso = Fichero."
            },
            {
                q: "En una Base de Datos Nativa XML, ¬øqu√© elemento desempe√±a un rol an√°logo al de las TABLAS en relacional?",
                options: [
                    "Las colecciones.",
                    "Los identificadores.",
                    "Los nodos XML.",
                    "Los recursos."
                ],
                correct: 0,
                justification: "Agrupamos los documentos XML dentro de 'Colecciones', igual que agrupamos filas en 'Tablas'."
            },
            {
                q: "¬øQu√© API de an√°lisis sint√°ctico (parser) carga el documento XML completo en memoria como un √°rbol?",
                options: [
                    "DOM (Document Object Model)",
                    "SAX",
                    "XQuery",
                    "JAXB"
                ],
                correct: 0,
                justification: "DOM crea todo el √°rbol en RAM, lo que permite navegar adelante y atr√°s pero consume mucha memoria."
            },

            // === TEMA: HIBERNATE / ORM ===
            {
                q: "¬øQu√© representa el llamado 'desfase objeto-relacional' (Impedance Mismatch)?",
                options: [
                    "La diferencia estructural y de relaciones entre la POO (Objetos) y las Bases de Datos Relacionales.",
                    "Un error de conexi√≥n JDBC.",
                    "La necesidad de usar DDL.",
                    "Un fallo de latencia."
                ],
                correct: 0,
                justification: "Los objetos tienen herencia y grafos; las tablas tienen filas y claves for√°neas. Encajarlos es dif√≠cil."
            },
            {
                q: "¬øQu√© interfaz de la API JPA es la encargada de gestionar el ciclo de vida de las entidades (persist, merge, remove)?",
                options: [
                    "EntityTransaction",
                    "PersistenceUnit",
                    "EntityManager",
                    "EntityManagerFactory"
                ],
                correct: 2,
                justification: "El EntityManager es el 'jefe' que gestiona las entidades en JPA."
            },
            {
                q: "¬øCu√°l es una caracter√≠stica clave del HQL (Hibernate Query Language)?",
                options: [
                    "Requiere SQL nativo.",
                    "Solo se ejecuta en consola.",
                    "Est√° acoplado al gestor de BBDD.",
                    "Es orientado a objetos y es independiente del gestor de BBDD."
                ],
                correct: 3,
                justification: "HQL trabaja con CLASES Java (ej: 'from Cliente'), no con TABLAS SQL."
            },
            {
                q: "¬øCu√°l es la funci√≥n principal de la interfaz Session en Hibernate?",
                options: [
                    "Configuraci√≥n inicial.",
                    "Transformar objetos a SQL.",
                    "Es un objeto ligero que gestiona las transacciones y operaciones CRUD de objetos persistentes.",
                    "Cerrar la SessionFactory."
                ],
                correct: 2,
                justification: "Session es la interfaz principal de trabajo en Hibernate cl√°sico."
            },
            {
                q: "En el ciclo de vida Hibernate, ¬øen qu√© estado est√° un objeto que tiene ID en la base de datos y est√° asociado a una sesi√≥n activa?",
                options: [
                    "Transitorio (Transient)",
                    "Persistente (Persistent)",
                    "Ligado (Bound)",
                    "Separado (Detached)"
                ],
                correct: 1,
                justification: "Persistent: Tiene ID y la sesi√≥n lo est√° vigilando."
            },
            {
                q: "¬øQu√© anotaci√≥n se utiliza para indicar que un atributo NO se debe guardar en la base de datos?",
                options: [
                    "@Id",
                    "@OrderBy",
                    "@Transient",
                    "@Column"
                ],
                correct: 2,
                justification: "@Transient marca el atributo como 'no persistente' (Hibernate lo ignora)."
            },
            {
                q: "¬øCu√°l es la t√©cnica principal del ORM?",
                options: [
                    "La conversi√≥n autom√°tica de los datos de objetos a los atributos de las tablas relacionales y viceversa.",
                    "Sustituci√≥n de SQL por c√≥digo nativo.",
                    "Creaci√≥n de BBDD orientadas a objetos.",
                    "Uso exclusivo de JDBC."
                ],
                correct: 0,
                justification: "Mapear (traducir) el mundo de objetos al mundo de tablas autom√°ticamente."
            },
            {
                q: "En un archivo de mapeo Hibernate (.hbm.xml), ¬øqu√© elemento define la clave primaria?",
                options: [
                    "<generator>",
                    "<property>",
                    "<class>",
                    "<id>"
                ],
                correct: 3,
                justification: "La etiqueta <id> se usa en los XML antiguos de Hibernate para la Primary Key."
            },
            {
                q: "¬øCu√°l de las siguientes caracter√≠sticas destaca la independencia de la base de datos en las herramientas ORM?",
                options: [
                    "Solo compatibles con una BBDD.",
                    "Necesidad de reescribir consultas.",
                    "Uso obligatorio de XML.",
                    "La abstracci√≥n permite escribir consultas independientemente del gestor, facilitando la migraci√≥n."
                ],
                correct: 3,
                justification: "Dialectos: Cambias el dialecto y Hibernate traduce el HQL a Oracle, MySQL o lo que sea."
            },

            // === TEMA: PL/SQL Y OBJETOS ===
            {
                q: "En PL/SQL, ¬øqu√© tipo de dato se usa para almacenar datos complejos y grandes como im√°genes o videos?",
                options: [
                    "NUMBER",
                    "LARGE OBJECT (LOB)",
                    "BOOLEAN",
                    "BINARY_INTEGER"
                ],
                correct: 1,
                justification: "LOB (Large Object). BLOB para binarios (fotos), CLOB para caracteres (textos largos)."
            },
            {
                q: "Una caracter√≠stica de las BDOO es la Encapsulaci√≥n. ¬øEn qu√© consiste?",
                options: [
                    "La ocultaci√≥n de informaci√≥n del objeto, evitando accesos incorrectos.",
                    "Operaci√≥n aplicable a distintas clases.",
                    "Crear nuevos tipos a partir de existentes.",
                    "Representaci√≥n en filas y columnas."
                ],
                correct: 0,
                justification: "Encapsular es proteger los datos internos y solo exponer m√©todos p√∫blicos."
            },
            {
                q: "¬øQu√© comando DDL elimina por completo una tabla y todos sus registros?",
                options: [
                    "DROP",
                    "DELETE",
                    "ALTER",
                    "RENAME"
                ],
                correct: 0,
                justification: "DROP destruye el objeto. DELETE solo vac√≠a los datos."
            },
            {
                q: "En OQL (y XQuery FLWOR), ¬øqu√© s√≠mbolo se suele utilizar para definir una variable?",
                options: [
                    "$ (D√≥lar)",
                    "@",
                    "#",
                    "%"
                ],
                correct: 0,
                justification: "En expresiones FLWOR (XQuery) las variables SIEMPRE llevan '$' delante (ej: $x)."
            },
            {
                q: "¬øQu√© sentencia SQL (DDL) se usa en PL/SQL para crear un nuevo tipo de dato objeto?",
                options: [
                    "CREATE CLASS",
                    "CREATE TYPE",
                    "DECLARE OBJECT",
                    "CREATE OBJECT"
                ],
                correct: 1,
                justification: "La sintaxis Oracle es CREATE TYPE nombre_tipo AS OBJECT..."
            },
            {
                q: "¬øQu√© secci√≥n de un bloque PL/SQL es obligatoria y contiene la l√≥gica principal?",
                options: [
                    "EXCEPTION",
                    "END",
                    "BEGIN",
                    "DECLARE"
                ],
                correct: 2,
                justification: "Un bloque an√≥nimo siempre necesita BEGIN ... END. (DECLARE y EXCEPTION son opcionales)."
            },
            {
                q: "En BDOO, ¬øc√≥mo se define el polimorfismo?",
                options: [
                    "Ocultaci√≥n de datos.",
                    "La propiedad de una operaci√≥n que puede aplicarse a objetos de distinta clase.",
                    "Capacidad de guardar sin mapeo.",
                    "Relaci√≥n jer√°rquica."
                ],
                correct: 1,
                justification: "Polimorfismo: Una misma orden (ej: 'dibujar()') funciona distinto seg√∫n si el objeto es un C√≠rculo o un Cuadrado."
            },
            {
                q: "¬øQu√© utiliza OQL en sus sentencias en lugar de los nombres de tablas?",
                options: [
                    "El nombre de los atributos de la clase Java / Nombres de Clases.",
                    "Nombres de ficheros.",
                    "Direcciones de memoria.",
                    "IDs num√©ricos."
                ],
                correct: 0,
                justification: "OQL consulta sobre el modelo de objetos (Clases), no sobre el modelo relacional (Tablas)."
            },

            // === TEMA: EJB / COMPONENTES ===
            {
                q: "¬øQu√© tipo de EJB Session Bean mantiene el estado de conversaci√≥n (Stateful)?",
                options: [
                    "Singleton",
                    "Message Driven",
                    "Stateful",
                    "Stateless"
                ],
                correct: 2,
                justification: "Stateful = Con estado. Recuerda los datos del cliente entre varias llamadas."
            },
            {
                q: "¬øQu√© IDE es conocido por facilitar el desarrollo por m√≥dulos (Platform)?",
                options: [
                    "JBuilder",
                    "IntelliJ Idea",
                    "NetBeans",
                    "Eclipse"
                ],
                correct: 2,
                justification: "NetBeans es famoso por su 'NetBeans Platform' para aplicaciones modulares de escritorio."
            },
            {
                q: "En EJB, ¬øqu√© anotaci√≥n indica que los m√©todos pueden ser invocados por un cliente remoto?",
                options: [
                    "@Entity",
                    "@Remote",
                    "@Stateless",
                    "@Local"
                ],
                correct: 1,
                justification: "@Remote expone el bean fuera de la m√°quina virtual Java (JVM) actual."
            },
            {
                q: "En JavaBeans, ¬øc√≥mo se llama la propiedad que representa una lista de valores accesible por √≠ndice?",
                options: [
                    "Propiedad Restringida",
                    "Propiedad Indexada",
                    "Propiedad Ligada",
                    "Propiedad Simple"
                ],
                correct: 1,
                justification: "Indexada (Indexed) = Array o Lista. Se accede con un √≠ndice num√©rico."
            },
            {
                q: "¬øCu√°l NO es un tipo principal de EJB?",
                options: [
                    "Beans de Entidad (Entity Beans)",
                    "Beans de Interfaz (Interface Beans)",
                    "Beans Controlados por Mensajes (MDB)",
                    "Beans de Sesi√≥n (Session Beans)"
                ],
                correct: 1,
                justification: "Los tipos reales son Session, Entity (aunque ahora es JPA) y MessageDriven. 'Interface Bean' no existe."
            },
            {
                q: "¬øQu√© propiedad de un Java Bean desencadena un evento cuando su valor cambia?",
                options: [
                    "Propiedad Restringida",
                    "Propiedad Simple",
                    "Propiedad Indexada",
                    "Propiedad Ligada (Bound)"
                ],
                correct: 3,
                justification: "Bound (Ligada) avisa a los 'listeners' cuando cambia su valor."
            }
        ];

        // --- L√ìGICA DEL TEST ---
        let questions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let errors = 0;

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function initQuiz() {
            // Clonamos y barajamos preguntas
            questions = shuffle([...rawQuestions]);
            currentQuestionIndex = 0;
            score = 0;
            errors = 0;
            updateScore();
            loadQuestion();
        }

        function loadQuestion() {
            const q = questions[currentQuestionIndex];
            const total = questions.length;
            const progress = ((currentQuestionIndex) / total) * 100;
            
            document.getElementById('progress-bar').style.width = `${progress}%`;
            document.getElementById('question-text').innerText = `${currentQuestionIndex + 1}/${total}. ${q.q}`;
            
            // Detectar tema (simple heur√≠stica por texto)
            let topic = "GENERAL";
            if(q.q.includes("File") || q.q.includes("stream") || q.q.includes("b√∫fer")) topic = "FICHEROS";
            else if(q.q.includes("JDBC") || q.q.includes("SQL")) topic = "JDBC";
            else if(q.q.includes("XML") || q.q.includes("eXist") || q.q.includes("XQuery")) topic = "XML/NXD";
            else if(q.q.includes("Hibernate") || q.q.includes("ORM") || q.q.includes("JPA")) topic = "HIBERNATE";
            else if(q.q.includes("EJB") || q.q.includes("Bean")) topic = "COMPONENTES";
            
            document.getElementById('topic-badge').innerText = topic;

            // Resetear UI
            document.getElementById('feedback-container').classList.add('hidden');
            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';

            // Preparar opciones barajadas pero manteniendo referencia al √≠ndice original correcto
            let indices = q.options.map((_, i) => i);
            indices = shuffle(indices);

            indices.forEach(i => {
                const btn = document.createElement('button');
                btn.className = "btn-option w-full text-left p-4 rounded-lg bg-slate-700 hover:bg-slate-600 border border-slate-600 focus:outline-none focus:ring-2 focus:ring-blue-400";
                btn.innerText = q.options[i];
                btn.onclick = () => checkAnswer(i, q.correct, btn, indices);
                optionsContainer.appendChild(btn);
            });
        }

        function checkAnswer(selectedIndex, correctIndex, btnElement, allIndices) {
            // Deshabilitar botones
            const buttons = document.querySelectorAll('.btn-option');
            buttons.forEach(b => b.disabled = true);

            const isCorrect = selectedIndex === correctIndex;
            const q = questions[currentQuestionIndex];

            if (isCorrect) {
                btnElement.classList.remove('bg-slate-700', 'hover:bg-slate-600');
                btnElement.classList.add('bg-green-600', 'border-green-400', 'text-white');
                document.getElementById('feedback-title').innerHTML = "<span class='text-green-400'>¬°CORRECTO! üéâ</span>";
                score++;
            } else {
                btnElement.classList.remove('bg-slate-700', 'hover:bg-slate-600');
                btnElement.classList.add('bg-red-600', 'border-red-400', 'text-white');
                document.getElementById('feedback-title').innerHTML = "<span class='text-red-400'>INCORRECTO ‚ùå</span>";
                errors++;
                
                // Buscar y resaltar la correcta
                buttons.forEach((b, idx) => {
                    // El bot√≥n idx corresponde al √≠ndice allIndices[idx] de las opciones originales
                    if (allIndices[idx] === correctIndex) {
                        b.classList.remove('bg-slate-700');
                        b.classList.add('bg-green-600', 'border-green-400', 'ring-2', 'ring-green-400');
                    }
                });
            }

            updateScore();
            
            // Mostrar justificaci√≥n
            document.getElementById('feedback-text').innerText = q.justification;
            document.getElementById('feedback-container').classList.remove('hidden');
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < questions.length) {
                loadQuestion();
            } else {
                // Fin del test
                const finalScore = (score / questions.length * 10).toFixed(1);
                document.getElementById('quiz-container').innerHTML = `
                    <div class="text-center py-10">
                        <h2 class="text-4xl font-bold text-yellow-400 mb-4">¬°TEST FINALIZADO!</h2>
                        <p class="text-2xl text-white mb-6">Tu nota: <span class="font-bold ${finalScore >= 5 ? 'text-green-400' : 'text-red-400'}">${finalScore} / 10</span></p>
                        <p class="text-slate-400 mb-8">Has acertado ${score} de ${questions.length} preguntas.</p>
                        <button onclick="location.reload()" class="bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-8 rounded-full text-lg shadow-lg transform hover:scale-105 transition-all">
                            üîÑ Repetir Test
                        </button>
                    </div>
                `;
            }
        }

        function updateScore() {
            document.getElementById('score').innerText = score;
            document.getElementById('errors').innerText = errors;
        }

        // Arrancar
        initQuiz();
    </script>
</body>
</html>