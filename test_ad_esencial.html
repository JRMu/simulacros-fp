<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>游닄</text></svg>">
    <script data-goatcounter="https://jrenedo.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>

    <title>Test Acceso a datos - Preguntas/Respuestas Densas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #eef2ff; /* Fondo 칤ndigo muy suave */ }
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .option-card { transition: all 0.2s ease; }
        .option-card:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
        
        /* Animaci칩n suave para el bot칩n siguiente */
        #next-container { transition: all 0.3s ease; }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div class="bg-white rounded-2xl shadow-xl w-full max-w-3xl flex flex-col relative overflow-hidden min-h-[650px] border-t-4 border-indigo-600">
        
        <div class="bg-indigo-600 p-5 text-white flex justify-between items-center z-10 shadow-md flex-shrink-0">
            <h1 class="text-lg font-bold flex items-center gap-2">
                <i class="fas fa-database"></i> Test T칠cnico AD
            </h1>
            <div id="status-bar" class="hidden flex gap-3 text-sm font-medium">
                <div class="bg-indigo-700 px-3 py-1 rounded-lg flex items-center gap-2">
                    <span class="text-indigo-200"><i class="fas fa-check"></i> <span id="score-display">0</span></span>
                    <span class="text-red-200 ml-2"><i class="fas fa-times"></i> <span id="errors-display">0</span></span>
                </div>
                <div class="bg-indigo-500 px-3 py-1 rounded-full w-16 text-center">
                    <span id="current-q">1</span>/<span id="total-q">0</span>
                </div>
            </div>
        </div>

        <div class="flex-1 p-6 sm:p-8 overflow-y-auto flex flex-col bg-gray-50 relative">
            
            <div id="start-screen" class="text-center space-y-8 fade-in my-auto">
                <div class="w-24 h-24 bg-indigo-100 rounded-full flex items-center justify-center mx-auto text-indigo-600 text-4xl mb-4 shadow-sm">
                    <i class="fas fa-server"></i>
                </div>
                <div>
                    <h2 class="text-3xl font-bold text-gray-800 mb-2">Acceso a Datos</h2>
                    <p class="text-gray-500">Test Acceso a datos - Preguntas/Respuestas Densas</p>
                </div>
                
                <div class="grid grid-cols-2 gap-4 max-w-xs mx-auto text-sm text-gray-600">
                    <div class="bg-white p-3 rounded-lg border border-gray-200 shadow-sm">
                        <i class="fas fa-list-ol text-indigo-500 mb-1 block text-lg"></i>
                        <span id="start-total-q">--</span> Preguntas
                    </div>
                    <div class="bg-white p-3 rounded-lg border border-gray-200 shadow-sm">
                        <i class="fas fa-random text-indigo-500 mb-1 block text-lg"></i>
                        Aleatorio
                    </div>
                </div>

                <button onclick="startQuiz()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-10 rounded-xl w-full max-w-sm mx-auto shadow-lg transition-transform transform hover:scale-105 flex justify-center items-center gap-2 text-lg">
                    <i class="fas fa-play"></i> Comenzar Test
                </button>
            </div>

            <div id="quiz-screen" class="hidden flex flex-col fade-in w-full max-w-2xl mx-auto flex-grow">
                
                <div class="mb-6">
                    <span class="text-xs font-bold text-indigo-600 uppercase tracking-wider mb-2 block">Pregunta</span>
                    <h3 id="question-text" class="text-xl sm:text-2xl font-bold text-gray-800 leading-snug"></h3>
                </div>

                <div id="options-container" class="space-y-3 flex-grow">
                    </div>

                <div id="feedback-area" class="hidden mt-6 pt-6 border-t border-gray-200 fade-in">
                    <div class="flex gap-4 mb-4 items-start bg-white p-4 rounded-lg border border-gray-100 shadow-sm">
                        <div id="feedback-icon" class="text-2xl flex-shrink-0 mt-1"></div>
                        <div>
                            <h4 id="feedback-title" class="font-bold text-base mb-1"></h4>
                            <p id="feedback-text" class="text-gray-600 text-sm leading-relaxed"></p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="result-screen" class="hidden text-center space-y-8 fade-in my-auto">
                <div class="relative inline-block">
                    <div class="w-32 h-32 mx-auto rounded-full flex items-center justify-center text-5xl shadow-xl relative z-10 bg-white border-4" id="score-circle"></div>
                </div>
                
                <div>
                    <h2 class="text-4xl font-black text-gray-800 mb-1" id="final-score-text">0/0</h2>
                    <p class="text-gray-500 text-sm font-semibold uppercase">Resultado Final</p>
                </div>

                <div class="w-full bg-gray-200 rounded-full h-3 overflow-hidden max-w-sm mx-auto">
                    <div id="final-progress-bar" class="bg-indigo-600 h-full rounded-full transition-all duration-1000" style="width: 0%"></div>
                </div>
                
                <p id="score-message" class="font-medium text-indigo-700 text-lg"></p>

                <div class="flex flex-col gap-3 max-w-xs mx-auto pt-4">
                    <button id="retry-failed-btn" onclick="restartQuiz(true)" class="hidden bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-lg shadow-md w-full transition-colors flex justify-center items-center gap-2">
                        <i class="fas fa-hammer"></i> Repasar Fallos
                    </button>
                    <button onclick="restartQuiz(false)" class="bg-white border-2 border-indigo-600 text-indigo-600 hover:bg-indigo-50 font-bold py-3 px-6 rounded-lg w-full transition-colors">
                        <i class="fas fa-redo"></i> Reiniciar Todo
                    </button>
                </div>
            </div>

        </div>

        <div id="next-container" class="hidden bg-white border-t p-4 z-20 sticky bottom-0 w-full shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]">
            <button onclick="nextQuestion()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 rounded-xl text-lg shadow-md transition-colors flex justify-center items-center gap-2">
                Siguiente Pregunta <i class="fas fa-arrow-right"></i>
            </button>
        </div>

    </div>

    <script>
        // --- BANCO DE PREGUNTAS T칄CNICAS AD ---
        const rawQuestions = [
            // --- BLOQUE 1: FICHEROS & STREAMS ---
            {
                q: "En relaci칩n con la arquitectura de entrada/salida en Java, 쯖u치l es la distinci칩n t칠cnica fundamental entre la clase heredada 'java.io.File' y la interfaz 'java.nio.file.Path' introducida en la especificaci칩n NIO.2?",
                options: [
                    "La clase File es una representaci칩n abstracta moderna que permite el acceso no bloqueante, mientras que Path es una clase concreta heredada.",
                    "La interfaz Path es parte de la nueva API NIO.2 y ofrece una mayor versatilidad para manejar sistemas de archivos no predeterminados y enlaces simb칩licos, superando las limitaciones de File.",
                    "La clase File est치 marcada como 'deprecated' en las versiones actuales del JDK y no debe utilizarse, siendo Path su 칰nico reemplazo v치lido.",
                    "La interfaz Path se utiliza exclusivamente para la manipulaci칩n de archivos XML, mientras que File se utiliza para archivos binarios."
                ],
                correct: 1,
                justification: "Path (NIO.2) mejora a File permitiendo acceso a sistemas de ficheros virtuales, mejor manejo de errores y enlaces simb칩licos."
            },
            {
                q: "Con respecto a la manipulaci칩n de archivos de acceso aleatorio mediante la clase 'java.io.RandomAccessFile', 쯖u치l es la funci칩n exacta del m칠todo 'seek(long pos)' en contraposici칩n a otros m칠todos de posicionamiento?",
                options: [
                    "El m칠todo seek establece el puntero del archivo en una posici칩n relativa, sumando el valor 'pos' a la posici칩n actual del puntero.",
                    "El m칠todo seek establece el puntero del archivo en una posici칩n absoluta medida en bytes desde el comienzo del archivo.",
                    "El m칠todo seek mueve el contenido f칤sico del archivo hacia la posici칩n especificada, reescribiendo los bytes anteriores.",
                    "El m칠todo seek busca una cadena de texto espec칤fica dentro del archivo y devuelve su posici칩n absoluta."
                ],
                correct: 1,
                justification: "Seek es absoluto (desde el byte 0). SkipBytes ser칤a el relativo."
            },
            {
                q: "En el contexto del procesamiento de flujos de datos (Streams), 쯤u칠 diferencia conceptual existe entre las jerarqu칤as de clases basadas en 'InputStream/OutputStream' frente a las basadas en 'Reader/Writer'?",
                options: [
                    "InputStream/OutputStream est치n dise침adas para manejar flujos de caracteres Unicode de 16 bits, mientras que Reader/Writer manejan flujos de bytes puros de 8 bits.",
                    "InputStream/OutputStream est치n dise침adas para manejar flujos de bytes crudos (binarios), mientras que Reader/Writer est치n especializadas en el manejo de caracteres y texto.",
                    "InputStream/OutputStream son clases obsoletas de Java 1.0, mientras que Reader/Writer son sus reemplazos directos en la API NIO.",
                    "No existe diferencia conceptual; son alias para las mismas operaciones de bajo nivel del sistema operativo."
                ],
                correct: 1,
                justification: "Stream = Bytes (8 bits, Binario). Reader/Writer = Caracteres (16 bits, Texto)."
            },

            // --- BLOQUE 2: XML ---
            {
                q: "Analizando los modelos de an치lisis sint치ctico XML (Parsing), 쯖u치l es la desventaja cr칤tica del modelo DOM (Document Object Model) en comparaci칩n con el modelo SAX (Simple API for XML) al procesar documentos de gran volumen?",
                options: [
                    "El modelo DOM carga la estructura completa del documento en la memoria heap como un 치rbol de objetos, lo que puede provocar excepciones de falta de memoria (OutOfMemoryError) con archivos grandes.",
                    "El modelo DOM es un parser basado exclusivamente en eventos secuenciales, lo que impide la navegaci칩n hacia atr치s en el documento y dificulta las modificaciones.",
                    "El modelo DOM no permite la modificaci칩n de los nodos del documento una vez cargados, siendo una API de solo lectura estricta.",
                    "El modelo DOM requiere obligatoriamente que el documento XML tenga un esquema XSD asociado, mientras que SAX no lo requiere."
                ],
                correct: 0,
                justification: "La desventaja de DOM es el consumo de RAM al cargar todo el 치rbol. SAX no carga nada, solo lee."
            },
            {
                q: "En la arquitectura de Bases de Datos Nativas XML (como eXist-db), 쯖칩mo se define t칠cnicamente el concepto de 'Colecci칩n' dentro de la jerarqu칤a de almacenamiento?",
                options: [
                    "Una Colecci칩n es un archivo individual que contiene m칰ltiples documentos XML concatenados en una sola estructura ra칤z.",
                    "Una Colecci칩n es una estructura l칩gica equivalente a un directorio del sistema de archivos, que act칰a como contenedor de recursos (documentos XML o binarios) y subcolecciones.",
                    "Una Colecci칩n es un conjunto de 칤ndices estructurales generados autom치ticamente para optimizar las consultas XPath.",
                    "Una Colecci칩n es un tipo de dato primitivo de XQuery utilizado para almacenar arrays de resultados en memoria."
                ],
                correct: 1,
                justification: "En BBDD Nativas: Colecci칩n = Carpeta. Recurso = Archivo."
            },
            {
                q: "Seg칰n el est치ndar W3C y el temario oficial, 쯖u치l es la relaci칩n taxon칩mica y funcional entre el lenguaje XPath y el lenguaje XQuery?",
                options: [
                    "XQuery es un subconjunto limitado de XPath dise침ado espec칤ficamente para bases de datos relacionales, eliminando las funciones de navegaci칩n.",
                    "XPath es una extensi칩n de XQuery que a침ade capacidades de manipulaci칩n de datos (DML) como inserci칩n y borrado.",
                    "XQuery est치 considerado formalmente como una extensi칩n (superset) de XPath 2.0, incorporando sus expresiones de ruta y a침adiendo estructuras de control complejas (FLWOR).",
                    "Son lenguajes completamente independientes sin sintaxis compartida, siendo XPath para XSLT y XQuery para bases de datos."
                ],
                correct: 2,
                justification: "XQuery > XPath. Todo lo que hace XPath lo hace XQuery, pero XQuery a침ade bucles y uniones."
            },

            // --- BLOQUE 3: JDBC ---
            {
                q: "Dentro de la interfaz 'java.sql.Statement', 쯖u치l es la especificaci칩n correcta del m칠todo 'executeUpdate' en t칠rminos de su prop칩sito y valor de retorno?",
                options: [
                    "Se utiliza para ejecutar consultas de selecci칩n (SELECT) y devuelve un objeto ResultSet que contiene los datos recuperados.",
                    "Se utiliza para ejecutar sentencias de manipulaci칩n de datos (INSERT, UPDATE, DELETE) y devuelve un valor entero (int) que representa el n칰mero de filas afectadas.",
                    "Se utiliza para ejecutar sentencias de manipulaci칩n de datos (INSERT, UPDATE, DELETE) y devuelve un valor booleano (boolean) que indica si la operaci칩n fue exitosa.",
                    "Se utiliza para ejecutar procedimientos almacenados y devuelve un objeto CallableStatement con los par치metros de salida."
                ],
                correct: 1,
                justification: "executeUpdate para cambios (DML). Retorna int (filas). executeQuery para SELECT. Retorna ResultSet."
            },
            {
                q: "Desde el punto de vista de la seguridad y el rendimiento en JDBC, 쯖u치l es la justificaci칩n t칠cnica para priorizar el uso de 'PreparedStatement' sobre 'Statement'?",
                options: [
                    "PreparedStatement permite la precompilaci칩n de la sentencia SQL en el servidor de base de datos y evita la inyecci칩n SQL mediante el uso de par치metros bind (marcadores de posici칩n).",
                    "PreparedStatement permite la ejecuci칩n de sentencias DDL (Data Definition Language) que no est치n soportadas por la interfaz Statement est치ndar.",
                    "PreparedStatement ejecuta la consulta en un hilo separado de forma as칤ncrona, mejorando la respuesta de la interfaz de usuario.",
                    "PreparedStatement convierte autom치ticamente los resultados relacionales en objetos Java, eliminando la necesidad de mapeo manual."
                ],
                correct: 0,
                justification: "Dos claves: Precompilaci칩n (Rendimiento) y Par치metros (Seguridad/Anti-Inyecci칩n)."
            },
            {
                q: "En la gesti칩n de transacciones JDBC con 'AutoCommit' desactivado, 쯤u칠 comportamiento define el protocolo en caso de que la conexi칩n se cierre abruptamente sin invocar expl칤citamente al m칠todo 'commit()'?",
                options: [
                    "El motor de base de datos ejecuta un 'commit' impl칤cito para asegurar la consistencia y durabilidad de los datos introducidos hasta el momento.",
                    "El motor de base de datos mantiene los datos en un estado temporal de 'lectura sucia' hasta que se restablece la conexi칩n.",
                    "El motor de base de datos ejecuta un 'rollback' autom치tico, deshaciendo todas las operaciones realizadas en la transacci칩n actual para mantener la atomicidad.",
                    "El comportamiento es indefinido y depende exclusivamente de la configuraci칩n del sistema operativo del servidor."
                ],
                correct: 2,
                justification: "Sin commit expl칤cito, ante un cierre, la BD protege la integridad haciendo Rollback."
            },
            {
                q: "Con respecto a los tipos de datos LOB (Large Object) en JDBC, 쯖u치l es la distinci칩n sem치ntica entre los tipos CLOB y BLOB?",
                options: [
                    "CLOB se utiliza para almacenar grandes vol칰menes de datos binarios (im치genes, audio), mientras que BLOB se utiliza para grandes vol칰menes de texto.",
                    "CLOB se utiliza para almacenar grandes vol칰menes de texto basado en caracteres (Character Large Object), mientras que BLOB se utiliza para datos binarios puros (Binary Large Object).",
                    "CLOB es un tipo de dato obsoleto reemplazado por VARCHAR, mientras que BLOB sigue vigente para archivos multimedia.",
                    "Ambos tipos son id칠nticos en su estructura interna, diferenci치ndose 칰nicamente en el juego de caracteres utilizado para su codificaci칩n."
                ],
                correct: 1,
                justification: "C = Character (Texto). B = Binary (Binario)."
            },

            // --- BLOQUE 4: ORM & HIBERNATE (LEAKS INCLUIDOS) ---
            {
                q: "En el contexto del mapeo objeto-relacional (ORM), el problema de la 'Granularidad' se manifiesta debido a una discrepancia estructural. 쮺u치l de las siguientes afirmaciones describe con precisi칩n t칠cnica este fen칩meno?",
                options: [
                    "Se refiere a la situaci칩n en la que el modelo de objetos es de grano grueso (pocas clases), obligando a dividir una 칰nica entidad Java en m칰ltiples tablas SQL.",
                    "Se refiere a la situaci칩n en la que el modelo de objetos es de grano fino (muchas clases peque침as), permitiendo que m칰ltiples clases Java se mapeen a una 칰nica tabla de base de datos.",
                    "Se refiere a la incapacidad de los tipos de datos primitivos de Java para representar la precisi칩n granular de los tipos num칠ricos de SQL.",
                    "Se refiere a la limitaci칩n de Hibernate para gestionar relaciones de herencia cuando las clases tienen pocos atributos."
                ],
                correct: 1,
                justification: "Granularidad = Java tiene m치s clases (m치s finas) que tablas tiene la BD."
            },
            {
                q: "El problema de los 'Subtipos' es uno de los componentes del desajuste de impedancia (Impedance Mismatch). 쮺u치l es la causa t칠cnica fundamental de este conflicto?",
                options: [
                    "El lenguaje Java no soporta la herencia m칰ltiple de clases, mientras que el modelo relacional permite que una tabla herede de m칰ltiples tablas padre.",
                    "El modelo relacional est치ndar (SQL) carece de un mecanismo nativo de herencia de tablas, obligando al ORM a simular la jerarqu칤a de clases mediante estrategias de mapeo complejas.",
                    "Los subtipos en Java se resuelven en tiempo de compilaci칩n, lo que es incompatible con la resoluci칩n din치mica de tipos de las bases de datos SQL.",
                    "Las claves for치neas en SQL no pueden referenciar a tablas que formen parte de una estructura de herencia l칩gica."
                ],
                correct: 1,
                justification: "Java tiene 'extends'. SQL no. El ORM tiene que 'simular' esa herencia con tablas."
            },
            {
                q: "En relaci칩n con el ciclo de vida de los objetos en JPA/Hibernate, 쯤u칠 condici칩n define t칠cnicamente el estado 'Persistent' (o Managed) de una entidad?",
                options: [
                    "El objeto tiene una representaci칩n en la base de datos (identificador) y est치 actualmente asociado a una Sesi칩n (EntityManager) activa, por lo que los cambios se sincronizan autom치ticamente.",
                    "El objeto ha sido guardado en la base de datos, pero la Sesi칩n se ha cerrado, por lo que los cambios realizados en memoria no se sincronizar치n.",
                    "El objeto ha sido instanciado recientemente en memoria mediante el operador 'new' y a칰n no tiene correspondencia en la base de datos.",
                    "El objeto ha sido marcado para su eliminaci칩n en la base de datos y ser치 borrado f칤sicamente al confirmar la transacci칩n."
                ],
                correct: 0,
                justification: "Persistent = ID en BD + Session Activa (Vigilancia activa)."
            },
            {
                q: "쮺u치l es la diferencia arquitect칩nica y funcional entre las interfaces 'SessionFactory' y 'Session' en el marco de trabajo Hibernate?",
                options: [
                    "SessionFactory es un objeto ligero que se crea para cada petici칩n de usuario, mientras que Session es un objeto pesado y 칰nico para toda la aplicaci칩n.",
                    "SessionFactory es un objeto pesado, hilo-seguro y 칰nico por aplicaci칩n (Singleton), encargado de crear instancias ligeras y no hilo-seguras de Session para cada unidad de trabajo.",
                    "Session es la interfaz encargada de la configuraci칩n global y el mapeo de clases, mientras que SessionFactory se utiliza exclusivamente para ejecutar consultas HQL.",
                    "Ambas interfaces son funcionalmente equivalentes y pueden intercambiarse, siendo SessionFactory la implementaci칩n moderna de la interfaz Session."
                ],
                correct: 1,
                justification: "Factory = F치brica (Pesada, Una). Session = Producto/Sesi칩n (Ligera, Muchas)."
            },
            {
                q: "En el contexto de la gesti칩n de identidades, 쯖칩mo se describe el problema de 'Identidad' dentro del desajuste objeto-relacional?",
                options: [
                    "Java define la identidad de los objetos bas치ndose en la ubicaci칩n de memoria (==) o la igualdad l칩gica (equals), mientras que las bases de datos relacionales utilizan exclusivamente la Clave Primaria (PK).",
                    "Java utiliza identificadores num칠ricos 칰nicos globales (UUID) para todos los objetos, mientras que las bases de datos requieren claves primarias secuenciales.",
                    "Las bases de datos relacionales no permiten la existencia de dos filas con valores id칠nticos, mientras que Java permite m칰ltiples objetos con los mismos atributos.",
                    "El problema reside en que Java no permite el uso de claves compuestas, obligando a simplificar el modelo de base de datos."
                ],
                correct: 0,
                justification: "Identidad Java (Memoria) vs Identidad BD (PK). Son mecanismos distintos."
            },

            // --- BLOQUE 5: COMPONENTES & MANIFEST ---
            {
                q: "Con respecto al empaquetado y despliegue de aplicaciones Java, 쯖u치l es la funci칩n espec칤fica del archivo 'MANIFEST.MF' ubicado dentro del directorio META-INF de un archivo JAR?",
                options: [
                    "Contiene las definiciones de las dependencias de compilaci칩n del proyecto, permitiendo a herramientas como Maven descargar las librer칤as necesarias.",
                    "Proporciona metadatos en tiempo de ejecuci칩n sobre el contenido del archivo, incluyendo la definici칩n de la clase principal (Main-Class) y la ruta de clases (Class-Path) para librer칤as externas.",
                    "Almacena las credenciales de seguridad cifradas y los certificados digitales necesarios para la firma del c칩digo del componente.",
                    "Act칰a como un descriptor de despliegue para servidores de aplicaciones web, definiendo los servlets y los mapeos de URL."
                ],
                correct: 1,
                justification: "Es el DNI del JAR para EJECUTAR (Runtime). Define Main-Class y Class-Path."
            },
            {
                q: "En la especificaci칩n de Enterprise JavaBeans (EJB), 쯤u칠 caracter칤stica distingue fundamentalmente a un 'Stateless Session Bean' de un 'Stateful Session Bean'?",
                options: [
                    "El Stateless Bean mantiene el estado conversacional del cliente entre m칰ltiples llamadas a m칠todos, mientras que el Stateful Bean se reinicia en cada llamada.",
                    "El Stateless Bean no mantiene ning칰n estado conversacional asociado a un cliente espec칤fico, permitiendo que el contenedor reutilice la instancia para diferentes clientes (pooling).",
                    "El Stateless Bean est치 dise침ado para representar datos persistentes en la base de datos, mientras que el Stateful Bean contiene la l칩gica de negocio.",
                    "El Stateless Bean solo puede ser accedido de forma as칤ncrona mediante colas de mensajes, a diferencia del Stateful Bean que es s칤ncrono."
                ],
                correct: 1,
                justification: "Stateless = Sin memoria (Reutilizable/R치pido). Stateful = Con memoria (Cliente espec칤fico)."
            },
            {
                q: "쯈u칠 propiedad de un JavaBean se caracteriza por permitir que otros componentes (listeners) registren su inter칠s y sean notificados autom치ticamente cuando el valor de dicha propiedad cambia?",
                options: [
                    "Propiedad Indexada (Indexed Property), que permite acceder a un array de valores.",
                    "Propiedad Restringida (Constrained Property), que permite a los oyentes vetar el cambio.",
                    "Propiedad Ligada (Bound Property), que dispara eventos PropertyChangeEvent al modificarse.",
                    "Propiedad Simple (Simple Property), que expone m칠todos getter y setter est치ndar."
                ],
                correct: 2,
                justification: "Ligada (Bound) = Notifica el cambio. Restringida (Constrained) = Pide permiso (Veto)."
            },

            // --- BLOQUE 6: EXTRAS T칄CNICOS ---
            {
                q: "Al realizar consultas utilizando HQL (Hibernate Query Language), 쯖u치l es la diferencia sint치ctica cr칤tica respecto a SQL est치ndar?",
                options: [
                    "HQL utiliza nombres de tablas y columnas f칤sicas de la base de datos, ignorando el mapeo de objetos.",
                    "HQL es sensible a may칰sculas para las palabras clave (SELECT, FROM) pero insensible para los nombres de clases.",
                    "HQL opera sobre el modelo de objetos, utilizando nombres de Clases y Atributos Java en lugar de nombres de tablas y columnas SQL.",
                    "HQL requiere obligatoriamente el uso de procedimientos almacenados para realizar cualquier operaci칩n de selecci칩n."
                ],
                correct: 2,
                justification: "HQL consulta OBJETOS. Usas 'Usuario' (Clase), no 'tbl_users' (Tabla)."
            },
            {
                q: "쯈u칠 acci칩n de limpieza es imperativo realizar sobre un objeto 'java.sql.Connection' tras finalizar su uso en un bloque finally o try-with-resources?",
                options: [
                    "Invocar el m칠todo 'commit()' para asegurar que no queden datos pendientes.",
                    "Invocar el m칠todo 'close()' para liberar los recursos f칤sicos (sockets, memoria) tanto en el cliente como en el servidor de base de datos.",
                    "Invocar el m칠todo 'flush()' para vaciar el b칰fer de red.",
                    "Establecer la referencia del objeto a 'null' para que el recolector de basura lo elimine eventualmente."
                ],
                correct: 1,
                justification: "Si no haces close(), agotas el pool de conexiones y la BD deja de responder."
            },
            {
                q: "En el contexto de JPA, 쯖u치l es la finalidad de la anotaci칩n '@Transient' aplicada sobre un campo de una entidad?",
                options: [
                    "Indica que el campo es la clave primaria de la tabla y debe ser autogenerada.",
                    "Indica que el campo debe ser persistido en una tabla secundaria separada.",
                    "Indica que el campo no es persistente, es decir, no debe ser almacenado ni recuperado de la base de datos por el motor ORM.",
                    "Indica que el campo contiene datos sensibles y debe ser cifrado antes de guardarse."
                ],
                correct: 2,
                justification: "Transient = Ignorar en BD (Solo existe en memoria RAM)."
            },
            {
                q: "쮺u치l es la funci칩n del mecanismo de 'Dirty Checking' (Comprobaci칩n de Suciedad) implementado por Hibernate?",
                options: [
                    "Verificar la integridad referencial de las claves for치neas antes de realizar una inserci칩n.",
                    "Detectar autom치ticamente las modificaciones en el estado de los objetos persistentes y sincronizarlos con la base de datos sin necesidad de llamadas expl칤citas a 'update'.",
                    "Comprobar que los datos introducidos no contengan caracteres ilegales que puedan provocar inyecci칩n SQL.",
                    "Validar que la memoria cach칠 de segundo nivel est칠 sincronizada con la base de datos."
                ],
                correct: 1,
                justification: "Hibernate vigila los objetos. Si cambias algo, 칠l hace el UPDATE solo."
            }
        ];

        // --- L칍GICA DEL TEST ---
        let quizQuestions = [], failedQuestions = [], currentQuestionIndex = 0;
        let score = 0, errors = 0, isAnswered = false, isRetryMode = false;

        // Referencias DOM
        const els = {
            start: document.getElementById('start-screen'),
            quiz: document.getElementById('quiz-screen'),
            result: document.getElementById('result-screen'),
            status: document.getElementById('status-bar'),
            nextCont: document.getElementById('next-container'),
            qText: document.getElementById('question-text'),
            opts: document.getElementById('options-container'),
            curQ: document.getElementById('current-q'),
            totQ: document.getElementById('total-q'),
            scDisp: document.getElementById('score-display'),
            errDisp: document.getElementById('errors-display'),
            fbArea: document.getElementById('feedback-area'),
            fbTitle: document.getElementById('feedback-title'),
            fbText: document.getElementById('feedback-text'),
            fbIcon: document.getElementById('feedback-icon'),
            startTotal: document.getElementById('start-total-q')
        };

        // Inicializar
        els.startTotal.innerText = rawQuestions.length || 0;

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function startQuiz(retryMode = false) {
            isRetryMode = retryMode;
            let source = retryMode ? failedQuestions : JSON.parse(JSON.stringify(rawQuestions));
            
            if (source.length === 0) return alert("No hay preguntas para repasar.");

            // Barajar preguntas y opciones
            quizQuestions = shuffle([...source]).map(q => {
                const correctTxt = q.options[q.correct];
                q.options = shuffle(q.options);
                q.correct = q.options.indexOf(correctTxt);
                return q;
            });

            failedQuestions = [];
            currentQuestionIndex = 0; score = 0; errors = 0;
            updateStats();
            
            // UI Switch
            els.start.classList.add('hidden');
            els.result.classList.add('hidden');
            els.quiz.classList.remove('hidden');
            els.status.classList.remove('hidden');
            els.nextCont.classList.add('hidden'); // Ocultar bot칩n al inicio
            
            renderQuestion();
        }

        function updateStats() {
            els.curQ.innerText = currentQuestionIndex + 1;
            els.totQ.innerText = quizQuestions.length;
            els.scDisp.innerText = score;
            els.errDisp.innerText = errors;
        }

        function renderQuestion() {
            isAnswered = false;
            const q = quizQuestions[currentQuestionIndex];
            
            updateStats();
            els.qText.innerText = q.q;
            els.opts.innerHTML = '';
            els.fbArea.classList.add('hidden');
            els.nextCont.classList.add('hidden'); // Ocultar bot칩n "Siguiente"
            
            // Scroll arriba
            document.querySelector('.overflow-y-auto').scrollTop = 0;

            q.options.forEach((opt, index) => {
                const btn = document.createElement('button');
                btn.className = "option-card w-full text-left p-4 rounded-xl border-2 border-gray-200 bg-white text-gray-700 font-medium flex items-center gap-3 group hover:border-indigo-300";
                
                const letter = String.fromCharCode(65 + index);
                btn.innerHTML = `<span class="flex-shrink-0 w-8 h-8 flex items-center justify-center bg-gray-100 text-gray-500 rounded-full font-bold text-sm transition-colors group-hover:bg-indigo-100 group-hover:text-indigo-600">${letter}</span><span class="leading-snug">${opt}</span>`;
                
                btn.onclick = () => checkAnswer(index, btn);
                els.opts.appendChild(btn);
            });
        }

        function checkAnswer(idx, btn) {
            if (isAnswered) return;
            isAnswered = true;
            const q = quizQuestions[currentQuestionIndex];
            const isCorrect = idx === q.correct;
            const allBtns = els.opts.children;

            // Deshabilitar
            Array.from(allBtns).forEach(b => {
                b.disabled = true;
                b.classList.add('opacity-60', 'cursor-not-allowed');
                b.classList.remove('hover:border-indigo-300');
            });
            btn.classList.remove('opacity-60');

            if (isCorrect) {
                score++;
                styleBtn(btn, 'correct');
                showFeedback(true, q.justification);
            } else {
                errors++;
                failedQuestions.push(q);
                styleBtn(btn, 'incorrect');
                // Mostrar correcta
                const correctBtn = allBtns[q.correct];
                correctBtn.classList.remove('opacity-60');
                styleBtn(correctBtn, 'correct');
                showFeedback(false, q.justification);
            }
            
            updateStats();
            // MOSTRAR BOT칍N SIGUIENTE (FIJO ABAJO)
            els.nextCont.classList.remove('hidden');
        }

        function styleBtn(btn, type) {
            btn.classList.remove('border-gray-200', 'bg-white', 'text-gray-700');
            if (type === 'correct') {
                btn.classList.add('border-green-500', 'bg-green-50', 'text-green-900');
                btn.querySelector('span:first-child').className = "flex-shrink-0 w-8 h-8 flex items-center justify-center bg-green-200 text-green-700 rounded-full font-bold text-sm";
            } else {
                btn.classList.add('border-red-500', 'bg-red-50', 'text-red-900');
                btn.querySelector('span:first-child').className = "flex-shrink-0 w-8 h-8 flex items-center justify-center bg-red-200 text-red-700 rounded-full font-bold text-sm";
            }
        }

        function showFeedback(isCorrect, text) {
            els.fbArea.classList.remove('hidden');
            els.fbIcon.innerHTML = isCorrect ? '<i class="fas fa-check-circle text-green-500"></i>' : '<i class="fas fa-times-circle text-red-500"></i>';
            els.fbTitle.innerText = isCorrect ? "춰Correcto!" : "Soluci칩n Correcta:";
            els.fbTitle.className = `font-bold text-base mb-1 ${isCorrect ? 'text-green-700' : 'text-red-700'}`;
            els.fbText.innerText = text || "Sin justificaci칩n.";
            
            // Scroll suave hacia abajo
            setTimeout(() => {
                const container = document.querySelector('.overflow-y-auto');
                container.scrollTo({ top: container.scrollHeight, behavior: 'smooth' });
            }, 100);
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < quizQuestions.length) {
                renderQuestion();
            } else {
                showResult();
            }
        }

        function showResult() {
            els.quiz.classList.add('hidden');
            els.status.classList.add('hidden');
            els.nextCont.classList.add('hidden');
            els.result.classList.remove('hidden');

            const total = quizQuestions.length;
            const pct = Math.round((score / total) * 100);
            
            document.getElementById('final-score-text').innerText = `${score} / ${total}`;
            document.getElementById('final-progress-bar').style.width = `${pct}%`;

            // Bot칩n Repasar Fallos
            const retryBtn = document.getElementById('retry-failed-btn');
            retryBtn.classList.toggle('hidden', failedQuestions.length === 0);
            if (failedQuestions.length > 0) retryBtn.innerHTML = `<i class="fas fa-hammer"></i> Repasar ${failedQuestions.length} Fallos`;

            // Mensajes
            const circle = document.getElementById('score-circle');
            const msg = document.getElementById('score-message');
            circle.className = "w-32 h-32 mx-auto rounded-full flex items-center justify-center text-5xl shadow-xl relative z-10 bg-white border-4 mb-4";

            if (pct >= 90) {
                circle.classList.add('border-indigo-500', 'text-indigo-600');
                circle.innerHTML = '<i class="fas fa-trophy"></i>';
                msg.innerText = "춰IMPRESIONANTE! Nivel Experto 游끥";
            } else if (pct >= 50) {
                circle.classList.add('border-blue-500', 'text-blue-600');
                circle.innerHTML = '<i class="fas fa-thumbs-up"></i>';
                msg.innerText = "춰Aprobado! Buen trabajo 游녨";
            } else {
                circle.classList.add('border-red-500', 'text-red-600');
                circle.innerHTML = '<i class="fas fa-book-open"></i>';
                msg.innerText = "Toca estudiar m치s... 游닄";
            }
        }

        function restartQuiz(retry) {
            startQuiz(retry);
        }
    </script>
</body>
</html>
